# Maintainer: Mattia Procopio (astro.matto)  <matto.astro at gmail dot com>
pkgname=libcamera-py-bindings
pkgver=0.0.5
pkgrel=1
pkgdesc="A complex camera support library for Linux, Android, and ChromeOS"
arch=(x86_64 aarch64)
url="https://github.com/raspberrypi/libcamera"
license=('LGPLv2' 'MIT' 'GPLv3' 'BSD2' 'BSD3')
depends=('python' 'python-prctl' 'python-piexif')
makedepends=('pybind11' 'meson')
source=("libcamera::git+https://git.libcamera.org/libcamera/libcamera.git")
sha256sums=("SKIP")
# paru python-pidng-git kmsxx-git
build() {
    cd $srcdir/libcamera
    git checkout v0.0.5
    ls -ls ../
    patch -p1 < ../../sphinx.patch
    meson setup build -Dpycamera=enabled
}

package() {
    cd $srcdir/libcamera
    DESTDIR="$pkgdir" ninja -C build install

    mkdir $pkgdir/usr/lib/
    mv $pkgdir/usr/local/lib/python3.11 $pkgdir/usr/lib/
    rm -rf $pkgdir/usr/local
}
